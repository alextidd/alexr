% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_baf.R
\name{plot_baf}
\alias{plot_baf}
\title{Plot B-allele frequency (BAF) across chromosomes}
\usage{
plot_baf(p_dat, genes = NULL, refcds = NULL, p_alpha = 0.05, p_size = 0.01)
}
\arguments{
\item{p_dat}{A data frame containing variant data with columns:
\describe{
\item{chr}{Chromosome (will be converted to factor with levels 1-22, X, Y)}
\item{pos}{Position on chromosome}
\item{mut_vaf}{Mutation variant allele frequency}
\item{total_depth}{Total sequencing depth (filtered to >20)}
}}

\item{genes}{A character vector of gene names for annotation, or NULL.
If provided, gene coordinates will be looked up using the refcds file.
Default is NULL.}

\item{refcds}{Path to RefCDS reference file for gene coordinate lookup.
Required if genes are specified. Default is NULL.}

\item{p_alpha}{Transparency level for points (0-1). Default is 0.05.}

\item{p_size}{Size of points. Default is 0.01.}
}
\value{
A ggplot object showing BAF values across chromosomes.
}
\description{
Creates a genome-wide plot of B-allele frequencies showing both VAF and BAF
(1-VAF) values across all chromosomes. The plot includes alternating chromosome
backgrounds, gene annotations, and a reference line at 0.5.
}
\details{
The function creates a BAF plot with the following features:
\itemize{
\item Filters variants to those with total_depth > 20
\item Calculates BAF as 1 - VAF (B-allele frequency)
\item Displays both VAF and BAF values as points
\item Uses alternating gray/white backgrounds for chromosomes
\item Adds a red reference line at 0.5 (expected heterozygous frequency)
\item Facets by chromosome with free scaling
\item Optional gene annotation as vertical lines
\item Removes x-axis labels for cleaner display
}
}
\note{
This function has dependencies on undefined variables (opts, p_source)
that may need to be defined in the calling environment or passed as parameters.
}
\examples{
\dontrun{
library(ggplot2)
library(dplyr)
library(ggh4x)

# Example variant data
variants <- data.frame(
  chr = c("1", "2", "1", "X"),
  pos = c(1000000, 2000000, 1500000, 500000),
  mut_vaf = c(0.3, 0.7, 0.45, 0.6),
  total_depth = c(50, 80, 60, 40)
)

# Basic BAF plot
plot_baf(variants)

# With gene annotations
plot_baf(variants, genes = c("TP53", "KRAS"), refcds = "path/to/refcds.RData")
}

}
