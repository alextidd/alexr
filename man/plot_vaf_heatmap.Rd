% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_vaf_heatmap.R
\name{plot_vaf_heatmap}
\alias{plot_vaf_heatmap}
\title{Plot variant allele frequency (VAF) heatmap}
\usage{
plot_vaf_heatmap(p_dat, p_title = "", annotations = c(), show_rownames = TRUE)
}
\arguments{
\item{p_dat}{A data frame containing variant data with columns:
\describe{
\item{gene}{Gene name}
\item{chr}{Chromosome}
\item{pos}{Position}
\item{ref}{Reference allele}
\item{alt}{Alternative allele}
\item{alt_vaf}{Variant allele frequency (0-1)}
\item{id}{Identifier}
\item{...}{Additional columns for annotations (specified in annotations parameter)}
}}

\item{p_title}{Character string for the plot title prefix. Default is an empty string.
The final title will be "p_title VAF heatmap n IDs, m mutations".}

\item{annotations}{Character vector of column names in p_dat to use for column annotations.
Default is an empty vector (no annotations).}

\item{show_rownames}{Logical indicating whether to show row names (mutation IDs) on the heatmap.
Default is TRUE.}
}
\value{
A pheatmap object. The function displays the heatmap directly.
}
\description{
Creates a clustered heatmap showing variant allele frequencies across identifiers
and mutations. The heatmap displays VAF values with hierarchical clustering
of both rows (mutations) and columns (identifiers), with optional annotations.
}
\details{
The function creates a VAF heatmap with the following features:
\itemize{
\item Filters to mutations with VAF > 0
\item Creates mutation IDs in format: gene_chr_pos_ref_alt
\item Hierarchical clustering of both rows (mutations) and columns (IDs)
\item Row annotations show the number of IDs with each mutation
\item Column annotations can be specified for additional ID metadata
\item Uses reversed magma color palette (viridis package)
\item NA values are replaced with 0
\item Title includes total ID and mutation counts
}
}
\examples{
\dontrun{
library(dplyr)
library(pheatmap)

# Example variant data
variants <- data.frame(
  gene = c("TP53", "KRAS", "TP53"),
  chr = c("17", "12", "17"),
  pos = c(7577120, 25398281, 7577121),
  ref = c("C", "G", "A"),
  alt = c("T", "A", "G"),
  alt_vaf = c(0.45, 0.32, 0.28),
  id = c("cell1", "cell2", "cell1"),
  sample_type = c("tumor", "tumor", "normal")
)

plot_vaf_heatmap(variants, "Sample 1", annotations = "sample_type")
}

}
