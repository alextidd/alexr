% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mutlist_to_96_contexts.R
\name{muts_to_96_contexts}
\alias{muts_to_96_contexts}
\title{Convert mutation list to 96-context trinucleotide mutation matrix}
\usage{
muts_to_96_contexts(muts, fasta)
}
\arguments{
\item{muts}{A data frame containing mutation data with columns:
\describe{
\item{sample_id}{Sample identifier}
\item{chr}{Chromosome (1-22, X, Y)}
\item{pos}{Position on chromosome}
\item{ref}{Reference allele (A, C, G, T)}
\item{alt}{Alternative allele (A, C, G, T)}
}}

\item{fasta}{A Rsamtools FaFile object or path to indexed FASTA file containing
the reference genome sequence for trinucleotide context extraction.}
}
\value{
A numeric matrix with 96 columns and one row per sample. Columns represent
the 96 possible trinucleotide contexts (6 substitution types × 16 trinucleotide
contexts). Row names are sample IDs and column names follow the format
"substitution,flanking-bases" (e.g., "C>A,A-A").
}
\description{
Converts a list of mutations into a 96-trinucleotide context mutation matrix
for mutational signature analysis. The function extracts trinucleotide contexts
from a reference genome and converts all mutations to pyrimidine base representation.
}
\details{
The function performs the following steps for each sample:
\itemize{
\item Filters mutations to standard chromosomes (1-22, X, Y) and valid bases (A,C,G,T)
\item Extracts trinucleotide context (position ± 1) from the reference genome
\item Converts all mutations to pyrimidine base representation (C>X or T>X)
\item For purine reference bases (A,G), converts to complement strand
\item Counts mutations for each of the 96 possible trinucleotide contexts
\item Returns a matrix suitable for mutational signature analysis
}

The 96 trinucleotide contexts consist of:
\itemize{
\item 6 substitution types: C>A, C>G, C>T, T>A, T>C, T>G
\item 16 trinucleotide contexts: all combinations of flanking bases (A,C,G,T)
}
}
\examples{
\dontrun{
library(GenomicRanges)
library(Rsamtools)

# Example mutation data
mutations <- data.frame(
  sample_id = c("sample1", "sample1", "sample2", "sample2"),
  chr = c("1", "2", "1", "3"),
  pos = c(1000000, 2000000, 1500000, 3000000),
  ref = c("C", "G", "A", "T"),
  alt = c("T", "A", "G", "C")
)

# Generate 96-context matrix
mut_matrix <- muts_to_96_contexts(mutations, "reference.fa")
}

}
